"use strict";(globalThis["webpackChunkopen_block_explorer"]=globalThis["webpackChunkopen_block_explorer"]||[]).push([[507],{88792:(e,t,o)=>{o.r(t),o.d(t,{default:()=>Qe});var r=o(59835),n=o(86970);const i={class:"row"},a={class:"col-12"},s={key:0,class:"items-center arrow-button"},l=(0,r._)("div",{class:"full-width text-center justify-center actor-font"},null,-1),c={class:"col-12"},p=(0,r._)("div",{class:"full-width text-center justify-center actor-font"},null,-1),d={key:0,class:"items-center arrow-button"},u={key:1,class:"col-12 map-data-position overlap-map"},v={key:0,class:"col-12 map-data-position"};function h(e,t,o,h,w,g){const m=(0,r.up)("q-icon"),f=(0,r.up)("WorldMap"),y=(0,r.up)("MapData"),x=(0,r.up)("PriceChart"),P=(0,r.up)("TransactionsTable");return(0,r.wg)(),(0,r.iD)("div",i,[(0,r._)("div",a,[e.mapDisplay?((0,r.wg)(),(0,r.iD)("div",{key:0,class:(0,n.C_)(["row header-support justify-center render-container",{"show-map":e.showMap}])},[(0,r._)("div",{class:"row full-width chevron-toggle hide",onClick:t[0]||(t[0]=(...t)=>e.toggleMap&&e.toggleMap(...t))},[e.showMap?((0,r.wg)(),(0,r.iD)("div",s,[(0,r.Wm)(m,{class:"fas fa-chevron-up q-pr-lg chevron",size:"17px"})])):(0,r.kq)("",!0),l]),(0,r._)("div",c,[(0,r.Wm)(f)])],2)):(0,r.kq)("",!0)]),e.mapDisplay?((0,r.wg)(),(0,r.iD)("div",{key:0,class:"row full-width chevron-toggle",onClick:t[1]||(t[1]=(...t)=>e.toggleMap&&e.toggleMap(...t))},[p,e.showMap?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("div",d,[(0,r.Wm)(m,{class:"fas fa-chevron-down q-pr-lg chevron",size:"17px"})])),(0,r._)("div",{class:(0,n.C_)(["map-hint",{"fade-in":e.showMapHint,"fade-out":!e.showMapHint}])},"(click or scroll to view producer map)",2)])):(0,r.kq)("",!0),e.mapDisplay&&e.showMap?((0,r.wg)(),(0,r.iD)("div",u,[(0,r.Wm)(y,{mapVisible:e.showMap},null,8,["mapVisible"])])):(0,r.kq)("",!0),(0,r._)("div",{class:(0,n.C_)(["container-max-width",{"container-margin":!e.showMap}])},[e.mapDisplay&&!e.showMap?((0,r.wg)(),(0,r.iD)("div",v,[(0,r.Wm)(y,{mapVisible:e.showMap},null,8,["mapVisible"])])):(0,r.kq)("",!0),(0,r.Wm)(x,{class:(0,n.C_)(["price-box-position",{"overlap-map":e.mapDisplay&&e.showMap}])},null,8,["class"]),(0,r.Wm)(P)],2)])}var w=o(60499);const g=e=>((0,r.dD)("data-v-6dae6bb4"),e=e(),(0,r.Cn)(),e),m={class:"price-chart row col-12 justify-center actor-font",align:"center"},f={class:"row col-11 price-box flex"},y={class:"col-xs-12 col-sx-12 col-md-6 col-lg-6 col-xs-6 q-pa-md"},x={class:"col-12 flex row q-mt-md"},P={class:"col-6 chart-info"},b=g((()=>(0,r._)("p",{class:"title"},"TOKEN PRICE",-1))),_={class:"sub-title"},k=g((()=>(0,r._)("p",{class:"border-line"},null,-1))),Z={class:"col-6 chart-info"},H=g((()=>(0,r._)("p",{class:"title"},"MARKETCAP",-1))),M={class:"sub-title"},T=g((()=>(0,r._)("p",{class:"border-line"},null,-1)));function F(e,t,o,i,a,s){return(0,r.wg)(),(0,r.iD)("div",m,[(0,r._)("div",f,[(0,r._)("div",y,[(0,r._)("div",x,[(0,r._)("div",P,[b,(0,r._)("p",_,(0,n.zw)(e.tokenPrice),1),k]),(0,r._)("div",Z,[H,(0,r._)("p",M,(0,n.zw)(e.marketCap),1),T])])])])])}var C=o(82341),D=o.n(C),I=o(15192),S=o.n(I),B=o(30229),L=o(52729),$=function(e,t,o,r){function n(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(t){i(t)}}function s(e){try{l(r["throw"](e))}catch(t){i(t)}}function l(e){e.done?o(e.value):n(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))};const q=(0,B.z)(),V=1e6,E=1e9;S()(D());const z=(0,r.aZ)({name:"PriceChart",components:{},setup(){const e=D(),t=(0,w.iH)({chart:{type:"area"},title:{text:"Past 24h"},xAxis:{dateTimeLabelFormats:{day:"%A, %b %e, %l %p",millisecond:"%A, %b %e, %l %p"},type:"datetime"},yAxis:{title:{text:"Price"}},legend:{enabled:!0},plotOptions:{area:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,(0,L.Z)("color-graph-shadow")]]},marker:{radius:.5},lineWidth:2,states:{hover:{lineWidth:4}},threshold:null}},series:[{name:q.getSystemToken().symbol,color:(0,L.Z)("primary"),data:[]}],tooltip:{dateTimeLabelFormats:{hour:"%A, %b %e, %l %p"}}}),o=(0,w.iH)(0),n=(0,w.iH)(""),i=(0,w.iH)(""),a=(0,w.iH)(""),s=(0,w.iH)(""),l=(0,w.iH)(""),c=()=>$(this,void 0,void 0,(function*(){const e=yield q.getPriceData();o.value=e.lastUpdated,n.value=d(e.tokenPrice),l.value=p(e.dayChange),s.value=d(e.dayVolume),i.value=d(e.marketCap),t.value.series[0].data=e.prices})),p=e=>`${e.toFixed(2)} %`,d=e=>e<1?`$${e.toFixed(3)}`:e<V?`$${e.toFixed(2)}`:e<E?`$${(e/V).toFixed(2)}M`:`$${(e/E).toFixed(2)}B`;return(0,r.bv)((()=>$(this,void 0,void 0,(function*(){yield c()})))),{hcInstance:e,chartOptions:t,lastUpdated:o,tokenPrice:n,marketCap:i,rank:a,dayVolume:s,dayChange:l,fetchPriceChartData:c,formatPercentage:p,formatCurrencyValue:d}}});var W=o(11639);const A=(0,W.Z)(z,[["render",F],["__scopeId","data-v-6dae6bb4"]]),N=A;var j=o(59311),G=o(61957);const O={class:"absolute q-pa-md producer-toggle text-white"},R={class:"map-container",id:"map",ref:"map-root"},U={class:"ol-popup",id:"popup",ref:"popup"},K={class:"ol-popup-closer",href:"#",id:"popup-closer",ref:"popup-closer"},Q={id:"popup-content",ref:"popup-content"},X={class:"ol-popup",id:"producerPopup",ref:"producerPopup"},Y={class:"ol-popup-closer",href:"#",id:"producerPopup-closer",ref:"producerPopup-closer"},J={id:"producerPopup-content",ref:"producerPopup-content"};function ee(e,t,o,n,i,a){const s=(0,r.up)("q-toggle");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("div",O,[(0,r.Wm)(s,{modelValue:e.producerToggle,"onUpdate:modelValue":[t[0]||(t[0]=t=>e.producerToggle=t),t[1]||(t[1]=t=>e.updateToggleOption(t))],label:"Show Active BP","left-label":"",color:"white"},null,8,["modelValue"])]),(0,r._)("div",R,null,512),(0,r._)("div",U,[(0,r.wy)((0,r._)("a",K,null,512),[[G.F8,e.$q.platform.is.mobile]]),(0,r._)("div",Q,null,512)],512),(0,r._)("div",X,[(0,r._)("a",Y,null,512),(0,r._)("div",J,null,512)],512)],64)}var te=o(21308),oe=o(54312),re=o(57617),ne=o(3244),ie=(o(1811),o(24553)),ae=o(98723),se=o(95695),le=o(3038),ce=o(33410),pe=o(95347),de=o(73504),ue=o(79100),ve=o(55335),he=o(36907),we=o(51317),ge=o(6884),me=o(33100),fe=o(78504),ye=o(98453),xe=function(e,t,o,r){function n(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(t){i(t)}}function s(e){try{l(r["throw"](e))}catch(t){i(t)}}function l(e){e.done?o(e.value):n(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))};const Pe=(0,r.aZ)({name:"WorldMap",components:{Map:te.Z,View:oe.ZP},setup(){const e=(0,fe.useStore)(),t=(0,w.iH)([40,40]),o=(0,w.iH)("EPSG:4326"),n=(0,w.iH)(8),i=(0,w.iH)(0),a=(0,w.iH)(Boolean(Number(localStorage.getItem("mapBP-toggle")))),s=(0,r.Fl)((()=>e.state.chain.bpList)),l=(0,r.Fl)((()=>e.state.chain.producerSchedule)),c=(0,r.Fl)((()=>e.state.chain.head_block_producer)),p=(0,w.iH)("");function d(e){localStorage.setItem("mapBP-toggle",Number(e).toString())}return{center:t,projection:o,zoom:n,rotation:i,BPlist:s,HeadProducer:c,currentHeadProducer:p,schedule:l,producerToggle:a,updateToggleOption:d}},data(){return{map:null,flashGeom:null,listenerKey:null,duration:2600,MapSource:null}},methods:Object.assign({},(0,me.nv)("chain",["updateBpList"])),mounted(){return xe(this,void 0,void 0,(function*(){yield this.updateBpList();const e=new ae.ZP({image:new se.Z({fill:new le.Z({color:"#FFFFFF"}),radius:5}),fill:new le.Z({color:(0,L.Z)("color-map")}),stroke:new ce.Z({color:(0,L.Z)("color-map"),width:1}),zIndex:50}),t=new ae.ZP({image:new se.Z({fill:new le.Z({color:"#8276d2"}),stroke:new ce.Z({color:"#63C9EF",width:3}),radius:5}),zIndex:51}),o=new ae.ZP({image:new se.Z({fill:new le.Z({color:"#8276d2"}),stroke:new ce.Z({color:"#FFFFFF",width:3}),radius:5}),zIndex:51}),r=new pe.Z({wrapX:!1,url:"https://openlayers.org/data/vector/ecoregions.json",format:new ie.Z}),n=new ye.Z({imageRatio:1,source:r,style:e}),i=new pe.Z({wrapX:!1}),a=new de.Z({source:i}),s=this.$refs["popup"],l=this.$refs["popup-content"],c=this.$refs["popup-closer"],p=this.$refs["producerPopup"],d=this.$refs["producerPopup-content"],u=this.$refs["producerPopup-closer"],v=new ne.Z({element:s,autoPan:{animation:{duration:250}}}),h=new ne.Z({element:p});c.onclick=function(){return v.setPosition(void 0),c.blur(),!1},u.onclick=function(){return h.setPosition(void 0),u.blur(),!1};const w=new te.Z({layers:[n,a],overlays:[v,h],target:"map",view:new oe.ZP({center:[0,0],zoom:0}),controls:[],interactions:[]});let g=null;function m(t,r){for(const n of t)if(n.org&&n.org.location){const t=n.org.location.longitude,a=n.org.location.latitude,s=new re.Z((0,ue.mi)([t,a])),l=new ve.Z(s);r.includes(n.owner)?l.setStyle(o):l.setStyle(e),l.setId(n.owner),l.setProperties({type:"bp",country:n.org.location.name}),i.addFeature(l)}else{const t=360*Math.random()-180,a=15*Math.random()-89,s=new re.Z((0,ue.mi)([t,a])),l=new ve.Z(s);r.includes(n.owner)?l.setStyle(o):l.setStyle(e),l.setId(n.owner),l.setProperties({type:"bp",country:"unknown"}),i.addFeature(l)}}w.on("singleclick",(e=>{null!==g&&g.getProperties().type&&"bp"===g.getProperties().type&&(v.setPosition(void 0),c.blur(),l.innerHTML="&nbsp;",g=null),w.forEachFeatureAtPixel(e.pixel,(function(e){e.getProperties().type&&"bp"===e.getProperties().type&&(g=e)})),g&&g.getProperties().type&&"bp"===g.getProperties().type?(l.innerHTML=(g.getId()===this.HeadProducer?'<div class="owner-text text-h6 text-center text-uppercase text-primary">Producing</div>':"")+'<div class="owner-text text-h6 text-center text-uppercase">'+g.getId()+'</div><div class="country-text text-subtitle1 text-center">'+g.getProperties().country+"</div>",v.setPosition(g.getGeometry().getCoordinates())):l.innerHTML="&nbsp;"})),w.on("pointermove",(e=>{null!==g&&g.getProperties().type&&"bp"===g.getProperties().type&&(v.setPosition(void 0),c.blur(),l.innerHTML="&nbsp;",g=null),w.forEachFeatureAtPixel(e.pixel,(function(e){e.getProperties().type&&"bp"===e.getProperties().type&&(g=e)})),g&&g.getProperties().type&&"bp"===g.getProperties().type?(l.innerHTML=(g.getId()===this.HeadProducer?'<div class="owner-text text-h6 text-center text-uppercase text-primary">Producing</div>':"")+'<div class="owner-text text-h6 text-center text-uppercase">'+g.getId()+'</div><div class="country-text text-subtitle1 text-center">'+g.getProperties().country+"</div>",v.setPosition(g.getGeometry().getCoordinates())):l.innerHTML="&nbsp;"}));const f=2600;function y(e){const t=Date.now(),o=e.getGeometry().clone(),r=a.on("postrender",n);function n(e){const n=e.frameState,i=n.time-t;if(i>=f)return void(0,ge.B)(r);const a=(0,we.u3)(e),s=i/f,l=25*(0,he.Vv)(s)+5,c=(0,he.Vv)(1-s),p=new ae.ZP({image:new se.Z({radius:l,stroke:new ce.Z({color:"rgba(255, 255, 255, "+c+")",width:.25+c})})});a.setStyle(p),a.drawGeometry(o),w.render()}}const x=()=>{if(this.HeadProducer!==this.currentHeadProducer){h.setPosition(void 0);let r=i.getFeatureById(this.HeadProducer),n=i.getFeatureById(this.currentHeadProducer);this.currentHeadProducer=this.HeadProducer,this.MapSource,null!==r&&(d.innerHTML=(r.getId()===this.HeadProducer?'<div class="owner-text text-h6 text-center text-uppercase text-primary">Producing</div>':"")+'<div class="owner-text text-h6 text-center text-uppercase">'+r.getId()+'</div><div class="country-text text-subtitle1 text-center">'+r.getProperties().country+"</div>",this.producerToggle&&h.setPosition(r.getGeometry().getCoordinates()),r.setStyle(t),y(r)),null!==n&&(this.schedule.includes(this.currentHeadProducer)?n.setStyle(o):n.setStyle(e))}};i.on("addfeature",(function(e){y(e.feature)})),window.setInterval((()=>{x()}),1e3),m(this.BPlist,this.schedule),this.map=w,this.MapSource=r}))}});var be=o(23175),_e=o(69984),ke=o.n(_e);const Ze=(0,W.Z)(Pe,[["render",ee],["__scopeId","data-v-9c30d6a4"]]),He=Ze;ke()(Pe,"components",{QToggle:be.Z});const Me=e=>((0,r.dD)("data-v-8161cf88"),e=e(),(0,r.Cn)(),e),Te={class:"col-3"},Fe={class:"row"},Ce=Me((()=>(0,r._)("div",{class:"col-12 text-subtitle1 text-weight-thin text-uppercase"},"Head Block",-1))),De={class:"col-12 text-subtitle1 text-bold"},Ie=Me((()=>(0,r._)("div",{class:"col-1"},[(0,r._)("div",{class:"hr-vertical"})],-1))),Se={class:"col-3"},Be={class:"row"},Le=Me((()=>(0,r._)("div",{class:"col-12 text-subtitle1 text-weight-thin text-uppercase"},"Producing",-1))),$e={class:"col-12 text-subtitle1 text-bold"},qe=Me((()=>(0,r._)("div",{class:"col-1"},[(0,r._)("div",{class:"hr-vertical"})],-1))),Ve={class:"col-3"},Ee={class:"row"},ze=Me((()=>(0,r._)("div",{class:"col-12 text-subtitle1 text-weight-thin text-uppercase"},"Irreversible Block",-1))),We={class:"col-12 text-subtitle1 text-bold"};function Ae(e,t,o,i,a,s){return(0,r.wg)(),(0,r.iD)("div",{class:(0,n.C_)(["row full-width text-center justify-center actor-font",{"text-grey-3":e.mapVisible}])},[(0,r._)("div",Te,[(0,r._)("div",Fe,[Ce,(0,r._)("div",De,(0,n.zw)(e.HeadBlock.toLocaleString()),1)])]),Ie,(0,r._)("div",Se,[(0,r._)("div",Be,[Le,(0,r._)("div",$e,(0,n.zw)(e.HeadBlockProducer),1)])]),qe,(0,r._)("div",Ve,[(0,r._)("div",Ee,[ze,(0,r._)("div",We,(0,n.zw)(e.lastIrreversibleBlock.toLocaleString()),1)])])],2)}const Ne=(0,r.aZ)({name:"MapData",props:{mapVisible:{type:Boolean,required:!0}},setup(){const e=(0,fe.useStore)(),t=(0,r.Fl)((()=>e.state.chain.head_block_producer)),o=(0,r.Fl)((()=>e.state.chain.head_block_num)),n=(0,r.Fl)((()=>e.state.chain.last_irreversible_block_num));return{HeadBlock:o,HeadBlockProducer:t,lastIrreversibleBlock:n}}}),je=(0,W.Z)(Ne,[["render",Ae],["__scopeId","data-v-8161cf88"]]),Ge=je;var Oe;(function(e){e[e["Reveal"]=0]="Reveal",e[e["Top"]=1]="Top",e[e["None"]=2]="None"})(Oe||(Oe={}));const Re=(0,r.aZ)({name:"PageNetwork",components:{PriceChart:N,TransactionsTable:j.Z,WorldMap:He,MapData:Ge},setup(){const e=(0,fe.useStore)(),t=B.Z.get().getCurrentChain().getMapDisplay(),o=(0,w.iH)(!1),n=(0,w.iH)(!1),i=100;let a,s=(0,w.iH)(Oe.None);const l=()=>{o.value=!o.value,o.value||s.value===Oe.None||(s.value=Oe.None)},c=()=>{if(0===document.documentElement.scrollTop){if(!o.value){if(s.value===Oe.None)return void(s.value=Oe.Top);s.value===Oe.Top&&(s.value=Oe.Reveal,l())}}else s.value=Oe.None};(0,r.YP)(s,(e=>{e===Oe.Top&&(n.value=!0,setTimeout((()=>{n.value=!1}),2e3))}));const p=function(){window.clearTimeout(a),a=setTimeout(c,i)},d=function(e){"ArrowUp"===e.key&&p()},u=()=>{window.removeEventListener("scroll",p),window.removeEventListener("wheel",p),window.removeEventListener("keyup",d)};return(0,r.bv)((()=>{t&&(window.addEventListener("scroll",p,!1),window.addEventListener("wheel",p,!1),window.addEventListener("keyup",d,!1),window.setInterval((()=>{e.dispatch("chain/updateBlockData")}),2e3))})),(0,r.Jd)((()=>{u()})),{mapDisplay:t,showMap:o,showMapHint:n,toggleMap:l}}});var Ue=o(22857);const Ke=(0,W.Z)(Re,[["render",h]]),Qe=Ke;ke()(Re,"components",{QIcon:Ue.Z})}}]);